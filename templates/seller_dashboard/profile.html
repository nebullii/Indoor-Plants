{% extends 'seller_dashboard/base_seller.html' %}

{% block title %}My Profile - Seller{% endblock %}

{% block seller_content %}
<div class="container py-4">
    <h2 class="mb-4 d-flex align-items-center">
        Store
        <button id="editProfileBtn" class="btn btn-link ms-2" title="Edit Profile">
            <i class="fas fa-pencil-alt"></i>
        </button>
    </h2>
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} auto-dismiss">{{ message }}</div>
      {% endfor %}
    {% endif %}
    <div class="card shadow-sm">
        <div class="card-body">
            <!-- Read-only profile details -->
            <dl class="row mb-0" id="profileDetails">
                <dt class="col-sm-3">Company Name</dt>
                <dd class="col-sm-9">{{ user.business_name|default:'-' }}</dd>
                <dt class="col-sm-3">Username</dt>
                <dd class="col-sm-9">{{ user.username }}</dd>
                <dt class="col-sm-3">Email</dt>
                <dd class="col-sm-9">{{ user.email }}</dd>
                <dt class="col-sm-3">Phone</dt>
                <dd class="col-sm-9">{{ user.phone|default:'-' }}</dd>
                <dt class="col-sm-3">Address</dt>
                <dd class="col-sm-9">{{ user.address|default:'-' }}</dd>
            </dl>
            <!-- Editable form, hidden by default -->
            <form method="post" novalidate id="profileForm" style="display:none;">
                {% csrf_token %}
                <div class="row mb-3">
                    <div class="col-md-6 mb-3">
                        <label for="id_business_name" class="form-label">Company Name</label>
                        {{ form.business_name }}
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="id_username" class="form-label">Username</label>
                        {{ form.username }}
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6 mb-3">
                        <label for="id_email" class="form-label">Email</label>
                        {{ form.email }}
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="id_phone" class="form-label">Phone</label>
                        {{ form.phone }}
                    </div>
                </div>
                <div class="mb-3">
                    <label for="id_address" class="form-label">Address</label>
                    {{ form.address }}
                </div>
                <button type="submit" class="btn btn-success">Save Changes</button>
                <button type="button" class="btn btn-secondary ms-2" id="cancelEditBtn">Cancel</button>
            </form>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const editBtn = document.getElementById('editProfileBtn');
        const profileDetails = document.getElementById('profileDetails');
        const profileForm = document.getElementById('profileForm');
        const cancelBtn = document.getElementById('cancelEditBtn');
        if (editBtn) {
            editBtn.addEventListener('click', function() {
                profileDetails.style.display = 'none';
                profileForm.style.display = 'block';
                editBtn.style.display = 'none';
            });
        }
        if (cancelBtn) {
            cancelBtn.addEventListener('click', function() {
                profileDetails.style.display = 'block';
                profileForm.style.display = 'none';
                editBtn.style.display = 'inline-block';
            });
        }
        // Auto-dismiss alert after 2 seconds
        setTimeout(function() {
            document.querySelectorAll('.auto-dismiss').forEach(function(el) {
                el.style.transition = 'opacity 0.5s';
                el.style.opacity = 0;
                setTimeout(function() { el.remove(); }, 500);
            });
        }, 2000);
    });
</script>
{% endblock %} 